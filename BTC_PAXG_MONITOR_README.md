# BTC/PAXG 价格比监控器

## 功能概述

本工具用于监控比特币(BTC)与黄金代币(PAXG)之间的价格比率，并将数据定期推送至钉钉。当价格比低于指定阈值时，会发送警报通知。

**主要功能：**
- 每5分钟自动计算BTC/PAXG价格比
- 将最新价格比推送到钉钉群组
- 当价格比低于26时发送警报通知
- 详细的日志记录，便于问题排查

## 安装与配置

### 前置条件

- Python 3.6 或更高版本
- requests 库
- 钉钉机器人 Webhook

### 安装步骤

1. **安装Python依赖**
   ```bash
   pip install requests
   ```

2. **配置钉钉机器人**
   - 登录钉钉，在需要接收通知的群组中添加自定义机器人
   - 复制机器人的 **Webhook URL** 和 **加签密钥**（如果设置了加签）

3. **配置脚本参数**
   打开 `btc_paxg_ratio_monitor.py` 文件，修改以下配置项：
   
   ```python
   # 钉钉机器人配置
   self.dingtalk_token = "your_dingtalk_robot_token"  # 替换为实际的token
   self.dingtalk_secret = "your_dingtalk_robot_secret"  # 替换为实际的secret（可选）
   
   # 监控配置
   self.alert_threshold = 26.0  # 警报阈值
   self.refresh_interval = 300  # 刷新间隔（秒）
   ```

## 使用方法

### 方法一：直接运行Python脚本

```bash
python btc_paxg_ratio_monitor.py
```

### 方法二：使用批处理文件（Windows）

双击运行 `run_btc_paxg_monitor.bat`，批处理文件会：
- 检查Python环境
- 安装缺失的依赖
- 启动监控器

## 功能详细说明

### 价格获取

工具通过Binance API获取BTCUSDT和PAXGUSDT的实时价格数据。

### 价格比计算

价格比计算公式：`Ratio = BTC价格 / PAXG价格`

### 钉钉消息推送

- **普通推送**：每5分钟发送一次当前价格比信息
- **警报推送**：当价格比低于26时发送警报通知，并@所有人

消息格式如下：

```markdown
### 📊 BTC/PAXG 价格比更新

**BTCUSDT价格**: $40,000.00
**PAXGUSDT价格**: $1,500.00
**BTC/PAXG 价格比**: 26.67

更新时间: 2023-11-15 10:30:00
```

### 日志记录

工具会在当前目录下生成 `btc_paxg_ratio.log` 日志文件，记录以下信息：
- 监控器启动和停止信息
- 每次价格比计算结果
- 消息发送状态
- 错误和异常信息

## 配置选项

### 可自定义的参数

1. **钉钉配置**
   - `dingtalk_token`: 钉钉机器人的访问令牌
   - `dingtalk_secret`: 钉钉机器人的加签密钥（可选）

2. **监控配置**
   - `alert_threshold`: 警报阈值，默认26.0
   - `refresh_interval`: 刷新间隔，默认300秒（5分钟）

### 钉钉机器人安全设置

如果在钉钉机器人安全设置中选择了"加签"，请确保设置了正确的 `dingtalk_secret` 值。

如果选择了"关键词"，请确保消息内容中包含设置的关键词（如"BTC"、"价格比"等）。

## 故障排除

### 常见问题

1. **无法获取价格数据**
   - 检查网络连接
   - 确认Binance API是否可访问
   - 查看日志文件获取详细错误信息

2. **钉钉消息发送失败**
   - 确认 `dingtalk_token` 是否正确
   - 如果设置了加签，确认 `dingtalk_secret` 是否正确
   - 检查钉钉机器人的安全设置，确保消息内容符合要求

3. **脚本运行异常**
   - 检查Python版本（需要3.6+）
   - 确认requests库已正确安装
   - 查看日志文件获取详细错误信息

### 如何验证配置是否正确

启动脚本后，会先进行一次初始价格检查并在控制台显示结果。如果能看到价格数据，则表示API配置正确。

## 注意事项

1. 请确保钉钉机器人的安全设置正确配置，避免消息发送失败
2. 建议定期检查日志文件，确保监控器正常运行
3. 如需调整监控频率或警报阈值，请修改脚本中的相应参数

## 支持的操作系统

- Windows
- macOS
- Linux

## 许可证

本项目为个人学习和使用目的开发，仅供参考。